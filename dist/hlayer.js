!function(){function t(t){this.index=++i.index,this.config=o.mergeJson(this.defaultConfig,t,this.index),this.init()}var e=["msg","alert","loading","iframe","prompt","photo","tips"],o={css:function(t,e){for(var o in e)t.style[o]=e[o]},getStyle:function(t,e){return t.currentStyle?t.currentStyle[e]:getComputedStyle(t,!1)[e]},move:function(t,e,i){clearInterval(t.timer),t.timer=setInterval(function(){var n=!0;for(attr in e){var s;s="opacity"==attr?parseInt(100*parseFloat(o.getStyle(t,attr))):parseInt(o.getStyle(t,attr));var l=(e[attr]-s)/7;l=l>0?Math.ceil(l):Math.floor(l),"opacity"==attr?(t.style[attr]=(s+l)/100,t.style.filter="alpha(opacity:"+s+l+")"):t.style[attr]=s+l+"px",s!=e[attr]&&(n=!1)}n&&(clearInterval(t.timer),i&&i())},16)},addEvent:function(t,e,o){return t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent?t.attachEvent("on"+e,o):t["on"+e]=o},removeEvent:function(t,e,o){t.removeEventListener?t.removeEventListener(e,o):t.detachEvent?t.detachEvent("on"+e,o):t["on"+e]=null},mergeJson:function(){for(var t={},e=0,o=arguments.length;e<o;e++)for(var i in arguments[e])t[i]=arguments[e][i];return t},creEle:function(t,e,o){var i=document.createElement(t);return e&&(i.className=e),o&&(i.id=o),i},addChild:function(t,e){if(e instanceof Array)for(var o=0,i=e.length;o<i;o++)t.appendChild(e[o]);else t.appendChild(e)},random:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)}},dom={body:document.body},i={index:1e5,times:0,msg:function(e){var i={type:"msg",title:!1,btn:!1},n={icon:!1,time:2e3,height:"50px"},s=o.mergeJson(n,e,i);new t(s)},alert:function(e){var i={type:"alert"},n={icon:!1,height:"148px",width:"260px",closeBtn:!0};n.btn=[],n.btnCb=[],e.confirmBtn!==!1&&n.btn.push("确定"),e.cancelBtn&&n.btn.push("取消"),e.confirmCb&&n.btnCb.push(e.confirmCb),e.cancelCb&&n.btnCb.push(e.cancelCb);var s=o.mergeJson(n,e,i);new t(s)},loading:function(e){var i={type:"loading",icon:!1,title:!1,btn:!1,text:!1},n={height:"100px",width:"100px",time:2e3,shadow:!1,loadingColor:"#169fe6"},s=o.mergeJson(n,e,i);new t(s)},iframe:function(e){var i={type:"iframe",icon:!1,btn:!1,text:!1},n={height:"500px",width:"700px",time:!1,shadow:!1,closeBtn:!0,url:"https://github.com/huruji/Hlayer"},s=o.mergeJson(n,e,i);new t(s)},prompt:function(e){var i={type:"prompt",icon:!1},n={height:"160px",width:"270px",time:!1,shadow:!1,closeBtn:!0};n.btn=[],n.btnCb=[],e.confirmBtn!==!1&&n.btn.push("确定"),e.cancelBtn&&n.btn.push("取消"),e.confirmCb&&n.btnCb.push(e.confirmCb),e.cancelCb&&n.btnCb.push(e.cancelCb);var s=o.mergeJson(n,e,i);new t(s)},photo:function(e){var i={type:"photo",icon:!1,move:!1,title:!1,closeBtn:!0,text:!1,closeType:2},n={time:!1,shadow:!0,animateType:3},s=o.mergeJson(n,e,i);new t(s),console.log(1e4)},tips:function(e){var i={type:"tips",move:!1,title:!1,closeBtn:!1,shadow:!1},n={time:1e3,shadow:!0,animateType:3,icon:!1,height:"40px"},s=o.mergeJson(n,e,i);new t(s)}};t.prototype={setConfig:function(){this.config.animateType.toString().indexOf("random")>-1&&(this.config.animateType=o.random(1,9)+"random"),this.config.type===e[2]&&(this.config.contentBg="transparent")},init:function(){this.setConfig(),this.times=++i.times,this.layer=o.creEle("div","hlayer hlayer"+this.times,"hlayer"+this.times),dom.body.appendChild(this.layer),this.layerCon=o.creEle("div","hlayer-content hlayer-"+this.config.type+" hlayer-animate"+parseInt(this.config.animateType)),this.layer.appendChild(this.layerCon),this.layer.style.zIndex=++i.index,console.dir(this.config),this.layout(),this.setStyle(),this.eventHandle()},layout:function(){if(this.layerTitle="",this.layerMain="",this.layerIcon="",this.layerBtnCON="",this.closeBtn="",this.layerBtns=[],this.layerShadow="",this.prompt=[],this.config.title!==!1&&(this.layerTitle=o.creEle("div","hlayer-content-title hlayer-"+this.config.type),this.layerTitle.textContent=this.config.title,o.css(this.layerTitle,{backgroundColor:this.config.mainBg,color:this.config.mainColor}),this.layerCon.appendChild(this.layerTitle)),this.config.shadow&&(this.layerShadow=o.creEle("div","hlayer-shadow"),this.layer.insertBefore(this.layerShadow,this.layerCon)),this.layerMain=o.creEle("div","hlayer-content-main hlayer-"+this.config.type+"-content"),this.layerCon.appendChild(this.layerMain),this.config.text&&(this.layerMain.innerHTML=this.config.text),this.config.icon!==!1){this.layerMain.style.paddingLeft="48px",this.layerIcon=o.creEle("div","hlayer-icon hlayer-icon"+this.config.icon);var t=o.creEle("i");this.layerIcon.appendChild(t),this.layerMain.appendChild(this.layerIcon)}if(this.config.btn){this.layerBtnCON=o.creEle("div","hlayer-content-btns hlayer-"+this.config.type+"-content-btns"),this.layerCon.appendChild(this.layerBtnCON);for(var i=0,n=this.config.btn.length;i<n;i++){var s=o.creEle("span","hlayer-content-btns-item hlayer-content-btns-item"+i);s.textContent=this.config.btn[i],o.css(s,{backgroundColor:this.config.mainBg,color:this.config.mainColor}),this.layerBtnCON.appendChild(s),this.layerBtns.push(s)}}if(this.config.closeBtn&&(this.closeBtn=o.creEle("div","hlayer-close hlayer-"+this.config.type+"close hlayer-close"+this.config.closeType),this.layerCon.appendChild(this.closeBtn)),this.config.loadingType&&this.config.type==e[2]){if(this.loading=o.creEle("div","hlayer-content-load hlayer-content-load"+this.config.loadingType),1===this.config.loadingType)for(var i=0;i<8;i++){var l=o.creEle("div");o.css(l,{backgroundColor:this.config.loadingColor}),this.loading.appendChild(l)}else if(2===this.config.loadingType)for(var i=0;i<2;i++){var l=o.creEle("div");o.css(l,{backgroundColor:this.config.loadingColor}),this.loading.appendChild(l)}else if(3===this.config.loadingType)for(var i=0;i<5;i++){var l=o.creEle("div","div"+(i+1));o.css(l,{backgroundColor:this.config.loadingColor}),this.loading.appendChild(l)}else if(4===this.config.loadingType)for(var i=0;i<5;i++){var l=o.creEle("div","div"+(i+1));o.css(l,{backgroundColor:this.config.loadingColor}),this.loading.appendChild(l)}this.layerMain.appendChild(this.loading),o.css(this.layerCon,{boxShadow:"none",background:"transparent"})}if(this.config.type==e[3]){var h=o.creEle("iframe","hlayer-content-iframe");o.css(h,{height:parseInt(this.config.height)-52+"px"}),h.src=this.config.url,this.layerMain.appendChild(h)}if(this.config.type==e[4])if(1===this.config.formType||2===this.config.formType){var r=o.creEle("input","hlayer-content-prompt hlayer-form-group hlayer-form-input");2===this.config.formType&&(r.type="password"),this.prompt.push(r),this.layerMain.appendChild(r)}else if(3===this.config.formType){var r=o.creEle("textarea","hlayer-content-prompt hlayer-form-group hlayer-form-textarea");this.prompt.push(r),o.css(r,{height:parseInt(this.config.height)-125+"px"}),this.layerMain.appendChild(r)}else if(4===this.config.formType)for(var i=0,n=this.config.options.inputs.length;i<n;i++){var a=o.creEle("label","hlayer-prompt-content-label"),r=o.creEle("input");r.type="radio",r.name=this.config.options.name,a.appendChild(r),this.prompt.push(r);var c=document.createTextNode(this.config.options.inputs[i]);a.appendChild(c),this.layerMain.appendChild(a)}else if(5===this.config.formType)for(var i=0,n=this.config.options.inputs.length;i<n;i++){var a=o.creEle("label","hlayer-prompt-content-label"),r=o.creEle("input");r.type="checkbox",r.name=this.config.options.name,a.appendChild(r),this.prompt.push(r);var c=document.createTextNode(this.config.options.inputs[i]);a.appendChild(c),this.layerMain.appendChild(a)}if(this.config.type===e[6]&&(this.tipsArrow=o.creEle("i",this.config.tipsPosition),this.layerMain.appendChild(this.tipsArrow)),this.config.type==e[5]){for(var that=this,p=[],i=0,n=this.config.photos.length;i<n;i++){var f=o.creEle("img");f.src=this.config.photos[i].img,p.push(f)}var d=setInterval(function(){for(var t=!0,e=0,i=p.length;e<i;e++)if(!p[e].complete){t=!1;break}t&&(clearInterval(d),that.photosIndex=that.photosIndex||0,console.log(2222),that.photoImg=o.creEle("img","hlayer-content-photo"),o.photoImg=o.css(that.photoImg,{display:"block"}),that.photoImgNext=o.creEle("div","hlayer-content-photo-next"),that.photoImgPre=o.creEle("div","hlayer-content-photo-pre"),o.css(that.layerMain,{padding:"0px"}),o.css(that.layerCon,{padding:"10px"}),that.photoText=o.creEle("div","hlayer-content-photo-text"),that.photoImg.src=that.config.photos[that.photosIndex].img,that.photoText.textContent=that.config.photos[that.photosIndex].text,that.layerMain.appendChild(that.photoImg),that.layerMain.appendChild(that.photoText),that.layerMain.appendChild(that.photoImgNext),that.layerMain.appendChild(that.photoImgPre),that.setStyle(),that.photoEventHandle())},50)}},setStyle:function(){o.css(this.layerMain,{background:this.config.contentBg,color:this.config.contentColor}),this.setHeight(),this.config.type===e[0]&&o.css(this.layerMain,{textAlign:"center"}),this.tipsArrow&&o.css(this.tipsArrow,{borderRightColor:this.config.contentBg}),this.position()},eventHandle:function(){var that=this;this.config.time&&setTimeout(function(){that.close()},this.config.time),this.closeBtn&&this.closeBtnHandle(),this.btnsHandle(),this.resize(),this.move()},photoEventHandle:function(){this.photoHover(),this.photoChange(),this.autoPlay()},photoHover:function(){var that=this;console.log(666),console.log(that.photoImg),that.photoImg&&(console.log(3353),o.addEvent(that.layerCon,"mouseover",function(){console.log(333),that.photoImgNext.style.display="block",that.photoImgPre.style.display="block",that.photoText.style.display="block"}),o.addEvent(that.layerCon,"mouseleave",function(){that.photoImgNext.style.display="none",that.photoImgPre.style.display="none",that.photoText.style.display="none"}))},photoChange:function(){var that=this;that.photoImg&&(o.addEvent(that.photoImgNext,"click",function(){that.photosIndex==that.config.photos.length-1?that.photosIndex=0:that.photosIndex+=1,this.photoTimer&&clearTimeout(this.photoTimer),console.log("next photo"),that.close(),that.init()}),o.addEvent(that.photoImgPre,"click",function(){0==that.photosIndex?that.photosIndex=that.config.photos.length-1:that.photosIndex-=1,this.photoTimer&&clearTimeout(this.photoTimer),that.close(),that.init()}))},autoPlay:function(){var that=this;console.log("playtime:"+this.config.playTime),this.config.autoPlay&&(this.photoTimer=setTimeout(function(){that.photoImgNext.click()},this.config.playTime))},resize:function(){var that=this;this.config.resize&&o.addEvent(window,"resize",function(){that.position.apply(that)})},move:function(){var that=this;this.layerTitle&&this.config.move&&(this.layerTitle.onmousedown=function(t){var e=t||window.event,i=e.clientX-that.layerCon.offsetLeft,n=e.clientY-that.layerCon.offsetTop;console.log(e.clientX,e.clientY),console.log(that.layerCon.offsetLeft,that.layerCon.offsetTop),console.log(i,n),document.onmousemove=function(t){var e=t||window.event,s=e.clientX-i+"px",l=e.clientY-n+"px";o.css(that.layerCon,{left:s,top:l}),document.onmouseup=function(){document.onmousemove=null}}})},setHeight:function(){this.config.width&&(this.layerCon.style.width=this.config.width),this.config.height&&(this.layerCon.style.height=this.config.height);var t=parseInt(this.config.height);this.layerTitle&&(t-=42),this.layerBtnCON&&(t-=40),o.css(this.layerMain,{height:t+"px",lineHeight:"30px"}),this.config.type!==e[0]&&this.config.type!==e[1]&&this.config.type!==e[6]||t&&(o.css(this.layerMain,{height:t+"px"}),o.css(this.layerMain,{lineHeight:t+"px"}))},close:function(){var that=this;that.layer.style.display="none",dom.body.removeChild(that.layer)},closeBtnHandle:function(){var that=this;o.addEvent(this.closeBtn,"click",function(){console.log(that.layer),that.layer.style.display="none",dom.body.removeChild(that.layer)})},btnsHandle:function(){var that=this;if(this.layerBtns&&this.config.btnCb)for(var t=0,i=this.layerBtns.length;t<i;t++)this.layerBtns[t]&&this.config.btnCb[t]&&!function(t){o.addEvent(that.layerBtns[t],"click",function(){if(that.close(),"function"==typeof that.config.btnCb[t]||"close"!=that.config.btnCb[t])if(that.config.type===e[4]&&0===t){var o=[];1===that.config.formType||2===that.config.formType||3===that.config.formType?that.prompt.forEach(function(t){o.push(t.value)}):4!==that.config.formType&&5!==that.config.formType||that.prompt.forEach(function(t,e){t.checked&&o.push({index:e,value:that.config.options.inputs[e]})}),1===o.length?that.config.btnCb[0](o[0]):that.config.btnCb[0](o)}else that.config.btnCb[t]()})}(t)},position:function(){var t="",i="";if(this.config.type===e[6]){var n=document.getElementById(this.config.tipsCon),s=n.offsetTop,l=n.offsetLeft,h=n.offsetHeight,r=n.offsetWidth,a=this.layerCon.offsetHeight,c=this.layerCon.offsetWidth;return console.log("parentTop"+s),console.log("parentLeft"+l),console.log("parentHeight"+h),console.log("parentWidth"+r),void("left"===this.config.tipsPosition?(console.log("document.scrollLeft"+document.scrollLeft),console.log("document.scrollTop"+document.scrollTop),i=l-c-10-document.body.scrollLeft+"px",t=s+(h-a)/2-document.body.scrollTop+"px",o.css(this.layerCon,{left:i,top:t})):"top"===this.config.tipsPosition?(i=l+(r-c)/2-document.body.scrollLeft+"px",t=s-a-10-document.body.scrollTop+"px",o.css(this.layerCon,{left:i,top:t})):"right"===this.config.tipsPosition?(i=l+r+10-document.body.scrollLeft+"px",t=s+(h-a)/2-document.body.scrollTop+"px",o.css(this.layerCon,{left:i,top:t})):"bottom"===this.config.tipsPosition&&(i=l+(r-c)/2-document.body.scrollLeft+"px",t=s+h+10-document.body.scrollTop+"px",o.css(this.layerCon,{left:i,top:t})))}var p=this.config.position,f=this.layerCon.offsetHeight,d=this.layerCon.offsetWidth;console.log("offsetHeight:"+this.layerCon.offsetHeight);var g=window.innerHeight,y=window.innerWidth;"random"===p&&(t=o.random(0,g-f)+"px",i=o.random(0,y-d)+"px",o.css(this.layerCon,{left:i,top:t})),0===p?(t=(g-f)/2+"px",i=(y-d)/2+"px",console.log(t),o.css(this.layerCon,{left:i,top:t})):1===p?o.css(this.layerCon,{top:"0px",left:"0px"}):2===p?(i=(y-d)/2+"px",o.css(this.layerCon,{top:"0px",left:i})):3===p?o.css(this.layerCon,{top:"0px",right:"0px"}):4===p?o.css(this.layerCon,{bottom:"0px",left:"0px"}):5===p?(i=(y-d)/2+"px",o.css(this.layerCon,{bottom:"0px",left:i})):6===p&&o.css(this.layerCon,{bottom:"0px",right:"0px"})},defaultConfig:{mainBg:"#169FE6",mainColor:"#fff",contentBg:"#fff",contentColor:"#000",title:"信息",text:"提示信息",width:"",height:"",confirmBtn:!0,confirmCb:!1,cancelBtn:!1,cancelCb:!1,animateType:1,resize:!0,position:0,shadow:!0,time:!1,loadingType:1,url:!1,closeBtn:!1,formType:1,move:!0,photos:!1,closeType:1,tipsPosition:"right",tipsCon:"",autoPlay:!1,playTime:5e3}},window.hlayer=i}(window);